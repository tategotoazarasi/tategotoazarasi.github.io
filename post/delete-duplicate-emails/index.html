<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script type=application/javascript src=https://tategotoazarasi.github.io/js/theme-mode.js></script>
<link rel=stylesheet href=https://tategotoazarasi.github.io/css/frameworks.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github-style.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/light.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/dark.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/syntax.css><title>LeetCode 196. Delete Duplicate Emails - Harp Seal Pup Nursery and Caring Center</title><link rel=icon type=image/x-icon href=/images/github.png><meta name=theme-color content="#1e2327"><meta name=description content="CreatetableIfNotExistsPerson(Idint,Emailvarchar(255));TruncatetablePerson;insertintoPerson(id,email)values(&amp;#39;1&amp;#39;,&amp;#39;john@example.com&amp;#39;);insertintoPerson(id,email)values(&amp;#39;2&amp;#39;,&amp;#39;bob@example.com&amp;#39;);insertintoPerson(id,email)values(&amp;#39;3&amp;#39;,&amp;#39;john@example.com&amp;#39;);Table: Person
   Column Name Type     id int   email varchar    id is the primary key column for this table. Each row of this table contains an email. The emails will not contain uppercase letters.
Write an SQL query to delete all the duplicate emails, keeping only one unique email with the smallest id. Note that you are supposed to write a DELETE statement and not a SELECT one.
Return the result table in any order.
The query result format is in the following example.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tategotoazarasi.github.io/post/delete-duplicate-emails/><meta name=twitter:card content="summary"><meta name=twitter:title content="LeetCode 196. Delete Duplicate Emails - Harp Seal Pup Nursery and Caring Center"><meta name=twitter:description content="CreatetableIfNotExistsPerson(Idint,Emailvarchar(255));TruncatetablePerson;insertintoPerson(id,email)values(&amp;#39;1&amp;#39;,&amp;#39;john@example.com&amp;#39;);insertintoPerson(id,email)values(&amp;#39;2&amp;#39;,&amp;#39;bob@example.com&amp;#39;);insertintoPerson(id,email)values(&amp;#39;3&amp;#39;,&amp;#39;john@example.com&amp;#39;);Table: Person
   Column Name Type     id int   email varchar    id is the primary key column for this table. Each row of this table contains an email. The emails will not contain uppercase letters.
Write an SQL query to delete all the duplicate emails, keeping only one unique email with the smallest id. Note that you are supposed to write a DELETE statement and not a SELECT one.
Return the result table in any order.
The query result format is in the following example.
"><meta name=twitter:site content="https://tategotoazarasi.github.io/"><meta name=twitter:creator content><meta name=twitter:image content="https://tategotoazarasi.github.io/"><meta property="og:type" content="article"><meta property="og:title" content="LeetCode 196. Delete Duplicate Emails - Harp Seal Pup Nursery and Caring Center"><meta property="og:description" content="CreatetableIfNotExistsPerson(Idint,Emailvarchar(255));TruncatetablePerson;insertintoPerson(id,email)values(&amp;#39;1&amp;#39;,&amp;#39;john@example.com&amp;#39;);insertintoPerson(id,email)values(&amp;#39;2&amp;#39;,&amp;#39;bob@example.com&amp;#39;);insertintoPerson(id,email)values(&amp;#39;3&amp;#39;,&amp;#39;john@example.com&amp;#39;);Table: Person
   Column Name Type     id int   email varchar    id is the primary key column for this table. Each row of this table contains an email. The emails will not contain uppercase letters.
Write an SQL query to delete all the duplicate emails, keeping only one unique email with the smallest id. Note that you are supposed to write a DELETE statement and not a SELECT one.
Return the result table in any order.
The query result format is in the following example.
"><meta property="og:url" content="https://tategotoazarasi.github.io/post/delete-duplicate-emails/"><meta property="og:site_name" content="LeetCode 196. Delete Duplicate Emails"><meta property="og:image" content="https://tategotoazarasi.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-02-09 15:54:42 +0800 +0800"></head><body><div style=position:relative><header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"><div class="Header-item mobile-none" style=margin-top:-4px;margin-bottom:-4px><a class=Header-link href=https://tategotoazarasi.github.io/><svg class="octicon" height="32" viewBox="0 0 16 16" width="32"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div><div class="Header-item d-md-none"><button class="Header-link btn-link js-details-target" type=button onclick='document.querySelector("#header-search").style.display=document.querySelector("#header-search").style.display=="none"?"block":"none"'><svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button></div><div style=display:none id=header-search class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"><div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"><div class=position-relative><form target=_blank action=https://www.google.com/search accept-charset=utf-8 method=get autocomplete=off><label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"><input type=text class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name=q placeholder=Search autocomplete=off>
<input type=hidden name=q value=site:https://tategotoazarasi.github.io/></label></form></div></div></div><div class="Header-item Header-item--full flex-justify-center d-md-none position-relative"><a class=Header-link href=https://tategotoazarasi.github.io/><svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" width="32"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div><div class=Header-item style=margin-right:0><a href=javascript:void(0) class="Header-link no-select" onclick=switchTheme()><svg style="fill:var(--color-profile-color-modes-toggle-moon)" class="no-select" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></a></div></header></div><script src=https://unpkg.com/@popperjs/core@2></script>
<script src=https://unpkg.com/tippy.js@6></script><div><main><div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4"><div class=px-0><div class="mb-3 d-flex px-3 px-md-3 px-lg-5"><div class="flex-auto min-width-0 width-fit mr-3"><div class=d-flex><div class="d-none d-md-block"><a class="avatar mr-2 flex-shrink-0" href=https://tategotoazarasi.github.io/><img class=avatar-user src=/images/myavatar.png width=32 height=32></a></div><div class="d-flex flex-column"><h1 class="break-word f3 text-normal mb-md-0 mb-1"><span class=author><a href=https://tategotoazarasi.github.io/>azarasi</a></span><span class=path-divider>/</span><strong class="css-truncate-target mr-1" style=max-width:410px><a href=https://tategotoazarasi.github.io/post/delete-duplicate-emails/>LeetCode 196. Delete Duplicate Emails</a></strong></h1><div class="note m-0">Created <relative-time datetime="Wed, 09 Feb 2022 15:54:42 +0800" class=no-wrap>Wed, 09 Feb 2022 15:54:42 +0800</relative-time>
<span class=file-info-divider></span>
Modified <relative-time datetime="Fri, 27 May 2022 04:57:46 +0000" class=no-wrap>Fri, 27 May 2022 04:57:46 +0000</relative-time></div></div></div></div></div></div></div><div class="container-lg px-3 new-discussion-timeline"><div class="repository-content gist-content"><div><div class="js-gist-file-update-container js-task-list-container file-box"><div id=file-pytest class="file my-2"><div id=post-header class="file-header d-flex flex-md-items-center flex-items-start sticky-header"><div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto"><div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0"><summary id=toc-toggle class="btn btn-octicon m-0 mr-2 p-2" aria-haspopup=menu aria-label="Table of Contents" role=button><svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zM3 8A1 1 0 111 8a1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/></svg></summary>450 Words</div><div class="file-actions flex-order-2 pt-0"><a class="muted-link mr-3" href=/tags/leetcode><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>leetcode</a>
<a class="muted-link mr-3" href=/tags/%E7%AE%80%E5%8D%95><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>简单</a>
<a class="muted-link mr-3" href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>数据库</a></div></div></div><div class="Box-body px-5 pb-5"><article class="markdown-body entry-content container-lg"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>Create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>If</span><span class=w> </span><span class=k>Not</span><span class=w> </span><span class=k>Exists</span><span class=w> </span><span class=n>Person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Id</span><span class=w>    </span><span class=nb>int</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Email</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Truncate</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>Person</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>Person</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>values</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;john@example.com&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>Person</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>values</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;bob@example.com&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>Person</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>values</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;3&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;john@example.com&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>Table: <code>Person</code></p><table><thead><tr><th>Column Name</th><th>Type</th></tr></thead><tbody><tr><td>id</td><td>int</td></tr><tr><td>email</td><td>varchar</td></tr></tbody></table><p>id is the primary key column for this table.
Each row of this table contains an email. The emails will not contain uppercase letters.</p><p>Write an SQL query to <strong>delete</strong> all the duplicate emails, keeping only one unique email with the smallest <code>id</code>. Note that you are supposed to write a <code>DELETE</code> statement and not a <code>SELECT</code> one.</p><p>Return the result table in <strong>any order</strong>.</p><p>The query result format is in the following example.</p><p><strong>Example 1:</strong></p><p><strong>Input:</strong>
Person table:</p><table><thead><tr><th>id</th><th>email</th></tr></thead><tbody><tr><td>1</td><td><a href=mailto:john@example.com>john@example.com</a></td></tr><tr><td>2</td><td><a href=mailto:bob@example.com>bob@example.com</a></td></tr><tr><td>3</td><td><a href=mailto:john@example.com>john@example.com</a></td></tr></tbody></table><p><strong>Output:</strong></p><table><thead><tr><th>id</th><th>email</th></tr></thead><tbody><tr><td>1</td><td><a href=mailto:john@example.com>john@example.com</a></td></tr><tr><td>2</td><td><a href=mailto:bob@example.com>bob@example.com</a></td></tr></tbody></table><p><strong>Explanation:</strong> <a href=mailto:john@example.com>john@example.com</a> is repeated two times. We keep the row with the smallest Id = 1.</p><h2 id=solution>Solution</h2><h4 id=方法一使用-delete-和-where-子句>方法一：使用 <code>DELETE</code> 和 <code>WHERE</code> 子句</h4><p><strong>算法</strong></p><p>我们可以使用以下代码，将此表与它自身在<em>电子邮箱</em>列中连接起来。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>Person</span><span class=w> </span><span class=n>p1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=n>Person</span><span class=w> </span><span class=n>p2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=n>Email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p2</span><span class=p>.</span><span class=n>Email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>然后我们需要找到其他记录中具有相同电子邮件地址的更大 ID。所以我们可以像这样给 <code>WHERE</code> 子句添加一个新的条件。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>Person</span><span class=w> </span><span class=n>p1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=n>Person</span><span class=w> </span><span class=n>p2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=n>Email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p2</span><span class=p>.</span><span class=n>Email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>p2</span><span class=p>.</span><span class=n>Id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>因为我们已经得到了要删除的记录，所以我们最终可以将该语句更改为 <code>DELETE</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DELETE</span><span class=w> </span><span class=n>p1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>Person</span><span class=w> </span><span class=n>p1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=n>Person</span><span class=w> </span><span class=n>p2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=n>Email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p2</span><span class=p>.</span><span class=n>Email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>p1</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>p2</span><span class=p>.</span><span class=n>Id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=方法二>方法二</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DELETE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>Person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>Email</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>Email</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>Email</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=k>FROM</span><span class=w> </span><span class=n>Person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>Email</span><span class=p>)</span><span class=w> </span><span class=n>b</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>WHERE</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=k>count</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>Id</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MIN</span><span class=p>(</span><span class=n>Id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=k>FROM</span><span class=w> </span><span class=n>Person</span><span class=p>)</span><span class=w> </span><span class=k>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>Email</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></article></div></div></div></div></div></div></main></div><script>window.onload=function(){const e=document.getElementById("post-header"),t=e.offsetHeight;document.documentElement.style.scrollPaddingTop=t+10+"px"};const tocToggleButton=document.getElementById("toc-toggle"),tippyInstance=tippy("#toc-toggle",{trigger:"click",content:'<div id="table-of-contents">\u003cnav id=\u0022TableOfContents\u0022\u003e\n  \u003cul\u003e\n    \u003cli\u003e\u003ca href=\u0022#solution\u0022\u003eSolution\u003c/a\u003e\n      \u003cul\u003e\n        \u003cli\u003e\u003c/li\u003e\n      \u003c/ul\u003e\n    \u003c/li\u003e\n  \u003c/ul\u003e\n\u003c/nav\u003e</div>',allowHTML:!0,placement:"bottom-start",interactive:!0,arrow:!1,maxWidth:"none",onHide:function(){tocToggleButton.classList.remove("hover")},onShow:function(){tocToggleButton.classList.add("hover")},onShown:function(){if(selectTableOfContentsOption(),window.hasSetupTableOfContentsListeners)return;const e=document.getElementById("table-of-contents");e.addEventListener("click",function(){tippyInstance[0].hide()}),window.hasSetupTableOfContentsListeners=!0}});function selectTableOfContentsOption(){const e="table-of-contents-option-selected",t=document.querySelectorAll("#table-of-contents > nav > ul li");for(const s of t){const[n]=s.children;if(n.tagName.toLowerCase()!=="a")continue;window.location.href===n.href?n.classList.add(e):n.classList.remove(e)}}window.onhashchange=selectTableOfContentsOption</script><div class="footer container-xl width-full p-responsive"><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><a aria-label=Homepage title=GitHub class="footer-octicon d-none d-lg-block mr-lg-4" href=https://tategotoazarasi.github.io/><svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"><li class="mr-3 mr-lg-0">Theme by <a href=https://github.com/MeiK2333/github-style>github-style</a></li></ul></div><div class="d-flex flex-justify-center pb-6"><span class="f6 text-gray-light"></span></div></div></body><script type=application/javascript src=https://tategotoazarasi.github.io/js/github-style.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></html>