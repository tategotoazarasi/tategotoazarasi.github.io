<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script type=application/javascript src=https://tategotoazarasi.github.io/js/theme-mode.js></script><link rel=stylesheet href=https://tategotoazarasi.github.io/css/frameworks.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github-style.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/light.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/dark.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/syntax.css><title>LeetCode 29. Divide Two Integers - Harp Seal Pup Nursery and Caring Center</title>
<link rel=icon type=image/x-icon href=/images/github.png><meta name=theme-color content="#1e2327"><meta name=description content="Given two integers dividend and divisor, divide two integers without using multiplication, division, and mod operator.
The integer division should truncate toward zero, which means losing its fractional part. For example, 8.345 would be truncated to 8, and -2.7335 would be truncated to -2.
Return the quotient after dividing dividend by divisor.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tategotoazarasi.github.io/post/divide-two-integers/><meta name=twitter:card content="summary"><meta name=twitter:title content="LeetCode 29. Divide Two Integers - Harp Seal Pup Nursery and Caring Center"><meta name=twitter:description content="Given two integers dividend and divisor, divide two integers without using multiplication, division, and mod operator.
The integer division should truncate toward zero, which means losing its fractional part. For example, 8.345 would be truncated to 8, and -2.7335 would be truncated to -2.
Return the quotient after dividing dividend by divisor.
"><meta name=twitter:site content="https://tategotoazarasi.github.io/"><meta name=twitter:creator content><meta name=twitter:image content="https://tategotoazarasi.github.io/"><meta property="og:type" content="article"><meta property="og:title" content="LeetCode 29. Divide Two Integers - Harp Seal Pup Nursery and Caring Center"><meta property="og:description" content="Given two integers dividend and divisor, divide two integers without using multiplication, division, and mod operator.
The integer division should truncate toward zero, which means losing its fractional part. For example, 8.345 would be truncated to 8, and -2.7335 would be truncated to -2.
Return the quotient after dividing dividend by divisor.
"><meta property="og:url" content="https://tategotoazarasi.github.io/post/divide-two-integers/"><meta property="og:site_name" content="LeetCode 29. Divide Two Integers"><meta property="og:image" content="https://tategotoazarasi.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-06-21 15:53:24 +0800 +0800"></head><body><div style=position:relative><header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"><div class="Header-item mobile-none" style=margin-top:-4px;margin-bottom:-4px><a class=Header-link href=https://tategotoazarasi.github.io/><img class=octicon height=32 width=32 src=/images/github.png></a></div><div class="Header-item d-md-none"><button class="Header-link btn-link js-details-target" type=button onclick='document.querySelector("#header-search").style.display=document.querySelector("#header-search").style.display=="none"?"block":"none"'><svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button></div><div style=display:none id=header-search class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"><div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"><div class=position-relative><form target=_blank action=https://www.google.com/search accept-charset=UTF-8 method=get autocomplete=off><label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"><input type=text class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name=q placeholder=Search autocomplete=off>
<input type=hidden name=q value=site:https://tategotoazarasi.github.io/></label></form></div></div></div><div class="Header-item Header-item--full flex-justify-center d-md-none position-relative"><a class=Header-link href=https://tategotoazarasi.github.io/><img class="octicon octicon-mark-github v-align-middle" height=32 width=32 src=/images/github.png></a></div><div class=Header-item style=margin-right:0><a href=javascript:void(0) class="Header-link no-select" onclick=switchTheme()><svg style="fill:var(--color-profile-color-modes-toggle-moon)" class="no-select" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></a></div></header></div><div><main><div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4"><div class=px-0><div class="mb-3 d-flex px-3 px-md-3 px-lg-5"><div class="flex-auto min-width-0 width-fit mr-3"><div class=d-flex><div class="d-none d-md-block"><a class="avatar mr-2 flex-shrink-0" href=https://tategotoazarasi.github.io/><img class=avatar-user src=/images/myavatar.webp width=32 height=32></a></div><div class="d-flex flex-column"><h1 class="break-word f3 text-normal mb-md-0 mb-1"><span class=author><a href=https://tategotoazarasi.github.io/>azarasi</a>
</span><span class=path-divider>/</span>
<strong class="css-truncate css-truncate-target mr-1" style=max-width:410px><a href=https://tategotoazarasi.github.io/post/divide-two-integers/>LeetCode 29. Divide Two Integers</a></strong></h1><div class="note m-0">Created <relative-time datetime="Tue, 21 Jun 2022 15:53:24 +0800" class=no-wrap>Tue, 21 Jun 2022 15:53:24 +0800</relative-time>
<span class=file-info-divider></span>
Modified <relative-time datetime="Fri, 20 Sep 2024 12:36:21 +0000" class=no-wrap>Fri, 20 Sep 2024 12:36:21 +0000</relative-time></div></div></div></div></div></div></div><div class="container-lg px-3 new-discussion-timeline"><div class="repository-content gist-content"><div><div class="js-gist-file-update-container js-task-list-container file-box"><div id=file-pytest class="file my-2"><div id=post-header class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style=z-index:2><div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto"><div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0"><summary id=toc-toggle onclick=clickToc() class="btn btn-octicon m-0 mr-2 p-2"><svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zM3 8A1 1 0 111 8a1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/></svg></summary><details-menu class=SelectMenu id=toc-details style="display: none;"><div class="SelectMenu-modal rounded-3 mt-1" style=max-height:340px><div class="SelectMenu-list SelectMenu-list--borderless p-2" style=overscroll-behavior:contain id=toc-list></div></div></details-menu>2789 Words</div><div class="file-actions flex-order-2 pt-0"><a class="muted-link mr-3" href=/tags/leetcode><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
leetcode
</a><a class="muted-link mr-3" href=/tags/%E4%B8%AD%E7%AD%89><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
中等
</a><a class="muted-link mr-3" href=/tags/%E4%BD%8D%E8%BF%90%E7%AE%97><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
位运算
</a><a class="muted-link mr-3" href=/tags/%E6%95%B0%E5%AD%A6><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
数学</a></div></div></div><div class="Box-body px-5 pb-5" style=z-index:1><article class="markdown-body entry-content container-lg"><p>Given two integers <code>dividend</code> and <code>divisor</code>, divide two integers <strong>without</strong> using multiplication, division, and mod operator.</p><p>The integer division should truncate toward zero, which means losing its fractional part. For example, <code>8.345</code> would be truncated to <code>8</code>, and <code>-2.7335</code> would be truncated to <code>-2</code>.</p><p>Return <em>the <strong>quotient</strong> after dividing</em> <code>dividend</code> <em>by</em> <code>divisor</code>.</p><p><strong>Note:</strong> Assume we are dealing with an environment that could only store integers within the <strong>32-bit</strong> signed integer range: \([−2^{31}, 2^{31} − 1]\). For this problem, if the quotient is <strong>strictly greater than</strong> \(2^{31} - 1\), then return \(2^{31} - 1\), and if the quotient is <strong>strictly less than</strong> \(-2^{31}\), then return \(-2^{31}\).</p><p><strong>Example 1:</strong></p><pre><code>Input: dividend = 10, divisor = 3
Output: 3
Explanation: 10/3 = 3.33333.. which is truncated to 3.
</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: dividend = 7, divisor = -3
Output: -2
Explanation: 7/-3 = -2.33333.. which is truncated to -2.
</code></pre><p><strong>Constraints:</strong></p><ul><li>\(-2^{31} &lt;= dividend, divisor &lt;= 2^{31} - 1\)</li><li><code>divisor != 0</code></li></ul><h2 id=题解>题解</h2><h3 id=前言>前言</h3><p>由于题目规定了「只能存储 \(32\) 位整数」，本题解的正文部分和代码中都不会使用任何 \(64\) 位整数。<strong>诚然，使用 \(64\) 位整数可以极大地方便我们的编码，但这是违反题目规则的。</strong></p><p>如果除法结果溢出，那么我们需要返回 \(2^{31} - 1\) 作为答案。因此在编码之前，我们可以首先对于溢出或者容易出错的边界情况进行讨论</p><ul><li><p>当被除数为 \(32\) 位有符号整数的最小值 \(-2^{31}\) 时</p><ul><li><p>如果除数为 \(1\)，那么我们可以直接返回答案 \(-2^{31}\)</p></li><li><p>如果除数为 \(-1\)，那么答案为 \(2^{31}\)，产生了溢出。此时我们需要返回 \(2^{31} - 1\)。</p></li></ul></li><li><p>当除数为 \(32\) 位有符号整数的最小值 \(-2^{31}\) 时：</p><ul><li><p>如果被除数同样为 \(-2^{31}\)，那么我们可以直接返回答案 \(1\)；</p></li><li><p>对于其余的情况，我们返回答案 \(0\)。</p></li></ul></li><li><p>当被除数为 \(0\) 时，我们可以直接返回答案 \(0\)。</p></li></ul><p>对于一般的情况，根据除数和被除数的符号，我们需要考虑 \(4\) 种不同的可能性。因此，为了方便编码，我们可以将被除数或者除数取相反数，使得它们符号相同。</p><p>如果我们将被除数和除数都变为正数，那么可能会导致溢出。例如当被除数为 \(-2^{31}\) 时，它的相反数 \(2^{31}\) 产生了溢出。因此，我们可以考虑将被除数和除数都变为负数，这样就不会有溢出的问题，在编码时只需要考虑 \(1\) 种情况了。</p><p>如果我们将被除数和除数的其中（恰好）一个变为了正数，那么在返回答案之前，我们需要对答案也取相反数。</p><h3 id=方法一二分查找>方法一：二分查找</h3><p><strong>思路与算法</strong></p><p>根据「前言」部分的讨论，我们记被除数为 \(X\)，除数为 \(Y\)，并且 \(X\) 和 \(Y\) 都是负数。我们需要找出 \(X/Y\) 的结果 \(Z\)。\)Z\) 一定是正数或 \(0\)。</p><p>根据除法以及余数的定义，我们可以将其改成乘法的等价形式，即：$$Z \times Y \geq X > (Z+1) \times Y$$因此，我们可以使用二分查找的方法得到 \(Z\)，即找出<strong>最大</strong>的 \(Z\) 使得 \(Z \times Y \geq X\) 成立。</p><p>由于我们不能使用乘法运算符，因此我们需要使用「快速乘」算法得到 \(Z \times Y\) 的值。「快速乘」算法与「快速幂」类似，前者通过加法实现乘法，后者通过乘法实现幂运算。「快速幂」算法可以参考<a href=https://leetcode-cn.com/problems/powx-n/solution/powx-n-by-leetcode-solution/>「50. Pow(x, n)」的官方题解</a>，「快速乘」算法只需要在「快速幂」算法的基础上，将乘法运算改成加法运算即可。</p><p><strong>细节</strong></p><p>由于我们只能使用 \(32\) 位整数，因此二分查找中会有很多细节。</p><p>首先，二分查找的下界为 \(1\)，上界为 \(2^{31} - 1\)。唯一可能出现的答案为 \(2^{31}\) 的情况已经被我们在「前言」部分进行了特殊处理，因此答案的最大值为 \(2^{31} - 1\)。如果二分查找失败，那么答案一定为 \(0\)。</p><p>在实现「快速乘」时，我们需要使用加法运算，然而较大的 \(Z\) 也会导致加法运算溢出。例如我们要判断 \(A + B\) 是否小于 \(C\) 时（其中 \(A, B, C\) 均为负数），\(A + B\) 可能会产生溢出，因此我们必须将判断改为 \(A &lt; C - B\) 是否成立。由于任意两个负数的差一定在 \([-2^{31} + 1, 2^{31} - 1]\) 范围内，这样就不会产生溢出。</p><p>读者可以阅读下面的代码和注释，理解如何避免使用乘法和除法，以及正确处理溢出问题。</p><p><strong>代码</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>divide</span><span class=p>(</span><span class=kt>int</span> <span class=n>dividend</span><span class=p>,</span> <span class=kt>int</span> <span class=n>divisor</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 考虑被除数为最小值的情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>dividend</span> <span class=o>==</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>INT_MIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>INT_MAX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 考虑除数为最小值的情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>==</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>dividend</span> <span class=o>==</span> <span class=n>INT_MIN</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 考虑被除数为 0 的情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>dividend</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 一般情况，使用二分查找
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 将所有的正数取相反数，这样就只需要考虑一种情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>bool</span> <span class=n>rev</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>dividend</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>dividend</span> <span class=o>=</span> <span class=o>-</span><span class=n>dividend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>rev</span> <span class=o>=</span> <span class=o>!</span><span class=n>rev</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>divisor</span> <span class=o>=</span> <span class=o>-</span><span class=n>divisor</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>rev</span> <span class=o>=</span> <span class=o>!</span><span class=n>rev</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 快速乘
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>auto</span> <span class=n>quickAdd</span> <span class=o>=</span> <span class=p>[](</span><span class=kt>int</span> <span class=n>y</span><span class=p>,</span> <span class=kt>int</span> <span class=n>z</span><span class=p>,</span> <span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// x 和 y 是负数，z 是正数
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// 需要判断 z * y &gt;= x 是否成立
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kt>int</span> <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>add</span> <span class=o>=</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>z</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 需要保证 result + add &gt;= x
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=k>if</span> <span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=n>x</span> <span class=o>-</span> <span class=n>add</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>+=</span> <span class=n>add</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>z</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=c1>// 需要保证 add + add &gt;= x
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=k>if</span> <span class=p>(</span><span class=n>add</span> <span class=o>&lt;</span> <span class=n>x</span> <span class=o>-</span> <span class=n>add</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>add</span> <span class=o>+=</span> <span class=n>add</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 不能使用除法
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>z</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>left</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>right</span> <span class=o>=</span> <span class=n>INT_MAX</span><span class=p>,</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>left</span> <span class=o>&lt;=</span> <span class=n>right</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 注意溢出，并且不能使用除法
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kt>int</span> <span class=n>mid</span> <span class=o>=</span> <span class=n>left</span> <span class=o>+</span> <span class=p>((</span><span class=n>right</span> <span class=o>-</span> <span class=n>left</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>bool</span> <span class=n>check</span> <span class=o>=</span> <span class=n>quickAdd</span><span class=p>(</span><span class=n>divisor</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>dividend</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>check</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>ans</span> <span class=o>=</span> <span class=n>mid</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 注意溢出
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=n>mid</span> <span class=o>==</span> <span class=n>INT_MAX</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=n>left</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>right</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>rev</span> <span class=o>?</span> <span class=o>-</span><span class=nl>ans</span> <span class=p>:</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p><strong>复杂度分析</strong></p><ul><li><p>时间复杂度：\(O(\log^2 C)\)，其中 \(C\) 表示 \(32\) 位整数的范围。二分查找的次数为 \(O(\log C)\)，其中的每一步我们都需要 \(O(\log C)\) 使用「快速乘」算法判断 \(Z \times Y \geq X\) 是否成立，因此总时间复杂度为 \(O(\log^2 C)\)。</p></li><li><p>空间复杂度：\(O(1)\)。</p></li></ul><h3 id=方法二类二分查找>方法二：类二分查找</h3><p><strong>前言</strong></p><p>常规意义下的二分查找为：给定区间 \([l, r]\)，取该区间的中点 \(\textit{mid} = \lfloor \dfrac{l+r}{2} \rfloor\)，根据 \(\textit{mid}\) 处是否满足某一条件，来决定移动左边界 \(l\) 还是右边界 \(r\)</p><p>我们也可以考虑另一种二分查找的方法</p><ul><li><p>记 \(k\) 为满足 \(2^k \leq r-l &lt; 2^{k+1}\) 的 \(k\) 值。</p></li><li><p>二分查找会进行 \(k+1\) 次。在第 \(i ~ (1 \leq i \leq k+1)\) 次二分查找时，设区间为 \([l_i, r_i]\)，我们取 \(\textit{mid} = l_i + 2^{k+1-i}\)</p></li><li><p>如果 \(\textit{mid}\) 不在 \([l_i, r_i]\) 的范围内，那么我们直接忽略这次二分查找；</p></li><li><p>如果 \(\textit{mid}\) 在 \([l_i, r_i]\) 的范围内，并且 \(\textit{mid}\) 处满足某一条件，我们就将 \(l_i\) 更新为 \(\textit{mid}\)，否则同样忽略这次二分查找。</p></li></ul><p>最终 \(l_i\) 即为二分查找的结果。这样做的正确性在于</p><blockquote><p>设在常规意义下的二分查找的答案为 \(\textit{ans}\)，记 \(\delta\) 为 \(\textit{ans}\) 与左边界的差值 \(\textit{ans} - l\)。\(\delta\) 不会大于 \(r-l\)，并且 \(\delta\) 一定可以用 \(2^k, 2^{k-1}, 2^{k-2}, \cdots, 2^1, 2^0\) 中的若干个元素之和表示（考虑 \(\delta\) 的二进制表示的意义即可）。因此上述二分查找是正确的。</p></blockquote><p><strong>思路与算法</strong></p><p>基于上述的二分查找的方法，我们可以设计出如下的算法</p><ul><li><p>我们首先不断地将 \(Y\) 乘以 \(2\)（通过加法运算实现），并将这些结果放入数组中，其中数组的第 \(i\) 项就等于 \(Y \times 2^i\)。这一过程直到 \(Y\) 的两倍严格小于 \(X\) 为止。</p></li><li><p>我们对数组进行逆序遍历。当遍历到第 \(i\) 项时，如果其大于等于 \(X\)，我们就将答案增加 \(2^i\)，并且将 \(X\) 中减去这一项的值。</p></li></ul><p>本质上，上述的逆序遍历就模拟了二分查找的过程。</p><p><strong>代码</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>divide</span><span class=p>(</span><span class=kt>int</span> <span class=n>dividend</span><span class=p>,</span> <span class=kt>int</span> <span class=n>divisor</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 考虑被除数为最小值的情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>dividend</span> <span class=o>==</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>INT_MIN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>INT_MAX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 考虑除数为最小值的情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>==</span> <span class=n>INT_MIN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>dividend</span> <span class=o>==</span> <span class=n>INT_MIN</span> <span class=o>?</span> <span class=mi>1</span> <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 考虑被除数为 0 的情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>dividend</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 一般情况，使用类二分查找
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 将所有的正数取相反数，这样就只需要考虑一种情况
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>bool</span> <span class=n>rev</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>dividend</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>dividend</span> <span class=o>=</span> <span class=o>-</span><span class=n>dividend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>rev</span> <span class=o>=</span> <span class=o>!</span><span class=n>rev</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>divisor</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>divisor</span> <span class=o>=</span> <span class=o>-</span><span class=n>divisor</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>rev</span> <span class=o>=</span> <span class=o>!</span><span class=n>rev</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>candidates</span> <span class=o>=</span> <span class=p>{</span><span class=n>divisor</span><span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 注意溢出
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>while</span> <span class=p>(</span><span class=n>candidates</span><span class=p>.</span><span class=n>back</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=n>dividend</span> <span class=o>-</span> <span class=n>candidates</span><span class=p>.</span><span class=n>back</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>candidates</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>candidates</span><span class=p>.</span><span class=n>back</span><span class=p>()</span> <span class=o>+</span> <span class=n>candidates</span><span class=p>.</span><span class=n>back</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>candidates</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>candidates</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>dividend</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>ans</span> <span class=o>+=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>dividend</span> <span class=o>-=</span> <span class=n>candidates</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>rev</span> <span class=o>?</span> <span class=o>-</span><span class=nl>ans</span> <span class=p>:</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p><strong>复杂度分析</strong></p><ul><li><p>时间复杂度：\(O(\log C)\)，即为二分查找需要的时间。方法二时间复杂度优于方法一的原因是：方法一的每一步二分查找都需要重新计算 \(Z \times Y\) 的值，需要 \(O(\log C)\) 的时间复杂度；而方法二的每一步的权重都是 \(2\) 的幂，在二分查找开始前就都是已知的值，因此我们可以在 \(O(\log C)\) 的时间内，一次性将它们全部预处理出来。</p></li><li><p>空间复杂度：\(O(\log C)\)，即为需要存储的 \(Y \times 2^i\) 的数量</p></li></ul></article></div></div></div></div></div></div></main></div><script type=application/javascript src=https://tategotoazarasi.github.io/js/toc.js></script><link rel=stylesheet href=https://tategotoazarasi.github.io/css/toc.css><div class="footer container-xl width-full p-responsive"><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><a aria-label=Homepage title=GitHub class="footer-octicon d-none d-lg-block mr-lg-4" href=https://tategotoazarasi.github.io/><svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"><li class="mr-3 mr-lg-0">Theme by <a href=https://github.com/MeiK2333/github-style>github-style</a></li></ul></div><div class="d-flex flex-justify-center pb-6"><span class="f6 text-gray-light"></span></div></div></body><script type=application/javascript src=https://tategotoazarasi.github.io/js/github-style.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css integrity=sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js integrity=sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload=renderMathInElement(document.body)></script></html>