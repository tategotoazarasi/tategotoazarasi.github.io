<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script type=application/javascript src=https://tategotoazarasi.github.io/js/theme-mode.js></script><link rel=stylesheet href=https://tategotoazarasi.github.io/css/frameworks.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github-style.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/light.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/dark.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/syntax.css><title>LeetCode 310. Minimum Height Trees - Harp Seal Pup Nursery and Caring Center</title>
<link rel=icon type=image/x-icon href=/images/github.png><meta name=theme-color content="#1e2327"><meta name=description content="A tree is an undirected graph in which any two vertices are connected by exactly one path. In other words, any connected graph without simple cycles is a tree.
Given a tree of n nodes labelled from 0 to n - 1, and an array of n - 1 edges where edges[i] = [ai, bi] indicates that there is an undirected edge between the two nodes ai and bi in the tree, you can choose any node of the tree as the root. When you select a node x as the root, the result tree has height h. Among all possible rooted trees, those with minimum height (i.e. min(h)) are called minimum height trees (MHTs).
Return a list of all MHTs&rsquo; root labels. You can return the answer in any order.
The height of a rooted tree is the number of edges on the longest downward path between the root and a leaf.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tategotoazarasi.github.io/post/minimum-height-trees/><meta name=twitter:card content="summary"><meta name=twitter:title content="LeetCode 310. Minimum Height Trees - Harp Seal Pup Nursery and Caring Center"><meta name=twitter:description content="A tree is an undirected graph in which any two vertices are connected by exactly one path. In other words, any connected graph without simple cycles is a tree.
Given a tree of n nodes labelled from 0 to n - 1, and an array of n - 1 edges where edges[i] = [ai, bi] indicates that there is an undirected edge between the two nodes ai and bi in the tree, you can choose any node of the tree as the root. When you select a node x as the root, the result tree has height h. Among all possible rooted trees, those with minimum height (i.e. min(h)) are called minimum height trees (MHTs).
Return a list of all MHTs&rsquo; root labels. You can return the answer in any order.
The height of a rooted tree is the number of edges on the longest downward path between the root and a leaf.
"><meta name=twitter:site content="https://tategotoazarasi.github.io/"><meta name=twitter:creator content><meta name=twitter:image content="https://tategotoazarasi.github.io/"><meta property="og:type" content="article"><meta property="og:title" content="LeetCode 310. Minimum Height Trees - Harp Seal Pup Nursery and Caring Center"><meta property="og:description" content="A tree is an undirected graph in which any two vertices are connected by exactly one path. In other words, any connected graph without simple cycles is a tree.
Given a tree of n nodes labelled from 0 to n - 1, and an array of n - 1 edges where edges[i] = [ai, bi] indicates that there is an undirected edge between the two nodes ai and bi in the tree, you can choose any node of the tree as the root. When you select a node x as the root, the result tree has height h. Among all possible rooted trees, those with minimum height (i.e. min(h)) are called minimum height trees (MHTs).
Return a list of all MHTs&rsquo; root labels. You can return the answer in any order.
The height of a rooted tree is the number of edges on the longest downward path between the root and a leaf.
"><meta property="og:url" content="https://tategotoazarasi.github.io/post/minimum-height-trees/"><meta property="og:site_name" content="LeetCode 310. Minimum Height Trees"><meta property="og:image" content="https://tategotoazarasi.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-04-06 15:03:31 +0800 +0800"></head><body><div style=position:relative><header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"><div class="Header-item mobile-none" style=margin-top:-4px;margin-bottom:-4px><a class=Header-link href=https://tategotoazarasi.github.io/><img class=octicon height=32 width=32 src=/images/github.png></a></div><div class="Header-item d-md-none"><button class="Header-link btn-link js-details-target" type=button onclick='document.querySelector("#header-search").style.display=document.querySelector("#header-search").style.display=="none"?"block":"none"'><svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button></div><div style=display:none id=header-search class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"><div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"><div class=position-relative><form target=_blank action=https://www.google.com/search accept-charset=UTF-8 method=get autocomplete=off><label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"><input type=text class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name=q placeholder=Search autocomplete=off>
<input type=hidden name=q value=site:https://tategotoazarasi.github.io/></label></form></div></div></div><div class="Header-item Header-item--full flex-justify-center d-md-none position-relative"><a class=Header-link href=https://tategotoazarasi.github.io/><img class="octicon octicon-mark-github v-align-middle" height=32 width=32 src=/images/github.png></a></div><div class=Header-item style=margin-right:0><a href=javascript:void(0) class="Header-link no-select" onclick=switchTheme()><svg style="fill:var(--color-profile-color-modes-toggle-moon)" class="no-select" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></a></div></header></div><div><main><div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4"><div class=px-0><div class="mb-3 d-flex px-3 px-md-3 px-lg-5"><div class="flex-auto min-width-0 width-fit mr-3"><div class=d-flex><div class="d-none d-md-block"><a class="avatar mr-2 flex-shrink-0" href=https://tategotoazarasi.github.io/><img class=avatar-user src=/images/myavatar.webp width=32 height=32></a></div><div class="d-flex flex-column"><h1 class="break-word f3 text-normal mb-md-0 mb-1"><span class=author><a href=https://tategotoazarasi.github.io/>azarasi</a>
</span><span class=path-divider>/</span>
<strong class="css-truncate css-truncate-target mr-1" style=max-width:410px><a href=https://tategotoazarasi.github.io/post/minimum-height-trees/>LeetCode 310. Minimum Height Trees</a></strong></h1><div class="note m-0">Created <relative-time datetime="Wed, 06 Apr 2022 15:03:31 +0800" class=no-wrap>Wed, 06 Apr 2022 15:03:31 +0800</relative-time>
<span class=file-info-divider></span>
Modified <relative-time datetime="Tue, 10 Sep 2024 08:15:10 +0000" class=no-wrap>Tue, 10 Sep 2024 08:15:10 +0000</relative-time></div></div></div></div></div></div></div><div class="container-lg px-3 new-discussion-timeline"><div class="repository-content gist-content"><div><div class="js-gist-file-update-container js-task-list-container file-box"><div id=file-pytest class="file my-2"><div id=post-header class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style=z-index:2><div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto"><div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0"><summary id=toc-toggle onclick=clickToc() class="btn btn-octicon m-0 mr-2 p-2"><svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zM3 8A1 1 0 111 8a1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/></svg></summary><details-menu class=SelectMenu id=toc-details style="display: none;"><div class="SelectMenu-modal rounded-3 mt-1" style=max-height:340px><div class="SelectMenu-list SelectMenu-list--borderless p-2" style=overscroll-behavior:contain id=toc-list></div></div></details-menu>2673 Words</div><div class="file-actions flex-order-2 pt-0"><a class="muted-link mr-3" href=/tags/leetcode><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
leetcode
</a><a class="muted-link mr-3" href=/tags/%E4%B8%AD%E7%AD%89><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
中等
</a><a class="muted-link mr-3" href=/tags/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
深度优先搜索
</a><a class="muted-link mr-3" href=/tags/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
广度优先搜索
</a><a class="muted-link mr-3" href=/tags/%E5%9B%BE><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
图
</a><a class="muted-link mr-3" href=/tags/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
拓扑排序</a></div></div></div><div class="Box-body px-5 pb-5" style=z-index:1><article class="markdown-body entry-content container-lg"><p>A tree is an undirected graph in which any two vertices are connected by <em>exactly</em> one path. In other words, any connected graph without simple cycles is a tree.</p><p>Given a tree of <code>n</code> nodes labelled from <code>0</code> to <code>n - 1</code>, and an array of <code>n - 1</code> <code>edges</code> where <code>edges[i] = [ai, bi]</code> indicates that there is an undirected edge between the two nodes <code>ai</code> and <code>bi</code> in the tree, you can choose any node of the tree as the root. When you select a node <code>x</code> as the root, the result tree has height <code>h</code>. Among all possible rooted trees, those with minimum height (i.e. <code>min(h)</code>)  are called <strong>minimum height trees</strong> (MHTs).</p><p>Return <em>a list of all <strong>MHTs&rsquo;</strong> root labels</em>. You can return the answer in <strong>any order</strong>.</p><p>The <strong>height</strong> of a rooted tree is the number of edges on the longest downward path between the root and a leaf.</p><p><strong>Example 1:</strong></p><p><img src=/images/310e1.jpg alt></p><blockquote><p><strong>Input:</strong> n = 4, edges = [[1,0],[1,2],[1,3]]</p><p><strong>Output:</strong> [1]</p><p><strong>Explanation:</strong> As shown, the height of the tree is 1 when the root is the node with label 1 which is the only MHT.</p></blockquote><p><strong>Example 2:</strong></p><p><img src=/images/310e2.jpg alt></p><blockquote><p><strong>Input:</strong> n = 6, edges = [[3,0],[3,1],[3,2],[3,4],[5,4]]</p><p><strong>Output:</strong> [3,4]</p></blockquote><p><strong>Constraints:</strong></p><ul><li>\(1 &lt;= n &lt;= 2 * 10^4\)</li><li><code>edges.length == n - 1</code></li><li>\(0 &lt;= a_i, b_i &lt; n\)</li><li>\(a_i != b_i\)</li><li>All the pairs \((a_i, b_i)\) are distinct.</li><li>The given input is <strong>guaranteed</strong> to be a tree and there will be <strong>no repeated</strong> edges.</li><li>How many MHTs can a graph have at most?</li></ul><h2 id=solution>Solution</h2><p>题目中给定的含有 \(n\) 个节点的树，可以推出含有以下特征</p><ul><li>任意两个节点之间有且仅有一条路径</li><li>树中的共有 \(n-1\) 条不同的边</li><li>叶子节点的度为 \(1\)，非叶子节点的度至少为 \(2\)</li><li>树的高度由根节点到叶子节点的最大距离决定。</li></ul><p>最直接的解法是，枚举以每个节点为根构成的树，然后求出该树的高度，所有树的最小高度即为答案，需要的时间复杂度为 \(O(n^2)\)，在此不再描述。</p><p>设 \(\textit{dist}[x][y]\) 表示从节点 \(x\) 到节点 \(y\) 的距离，假设树中距离最长的两个节点为 \((x,y)\)，它们之间的距离为 \(\textit{maxdist} = \textit{dist}[x][y]\)，则可以推出以任意节点构成的树最小高度一定为 \(\textit{minheight} = \Big \lceil \dfrac{\textit{maxdist}}{2} \Big \rceil\)，且最小高度的树根节点一定在 节点 \(x\) 到节点 \(y\) 的路径上。</p><ul><li>首先证明树的高度一定为 \(\textit{minheight} = \Big \lceil \dfrac{\textit{maxdist}}{2} \Big \rceil\)，可以用反证法证明，假设存在节点 \(z\)，以节点 \(z\) 为根的树的高度 \(h &lt; \textit{minheight}\)，则可以推出：<ul><li>如果节点 \(z\) 存在于从 \(x\) 到 \(y\) 的路径上，由于 \(x\) 与 \(y\) 均为叶子节点，则可以知道 \(x\) 到 \(z\) 距离与 \(y\) 到 \(z\) 距离均小于 \(\textit{minheight}\)，\(\textit{dist}[x][y] = \textit{dist}[x][z] + \textit{dist}[z][y] \le 2 \times \Big \lceil \dfrac{\textit{dist}[x][y]}{2} \Big \rceil - 2 &lt; \textit{dist}[x][y]\)，这与 \(x\) 到 \(y\) 的距离为 \(\textit{dist}[x][y]\) 相矛盾；</li><li>如果节点 \(z\) 不存在于 \(x\) 到 \(y\) 的路径上，假设 \(z\) 到 \(x\) 的路径为 \(z \rightarrow \cdots \rightarrow a \rightarrow \cdots \rightarrow x\)，\(z\) 到 \(y\) 的路径为 \(z \rightarrow \cdots \rightarrow a \rightarrow \cdots \rightarrow y\)，这两个路径之间一定存在公共的交叉点，假设交叉点为 \(a\)，则可以知道此时 \(z\) 到 \(x\) 的距离为 \(\textit{dist}[z][x] = \textit{dist}[z][a] + \textit{dist}[a][z]\)，\(z\) 到 \(y\) 的距离为 \(\textit{dist}[z][y] = \textit{dist}[z][a] + \textit{dist}[a][y]\)，由于树的高度小于 \(h &lt; \textit{minheight}\)，所以可以推出 \(\textit{dist}[z][a] + \textit{dist}[a][x] &lt; \textit{minheight}\)，\(\textit{dist}[z][a] + \textit{dist}[a][y] &lt; \textit{minheight}\)，即可以推出 \(\textit{dist}[a][x] + \textit{dist}[a][y] \le 2 \times \textit{minheight} - 2 = 2 \times \Big \lceil \dfrac{\textit{dist}[x][y]}{2} \Big \rceil - 2 &lt; \textit{dist}[x][y]\)，这与 \(x\) 到 \(y\) 的距离为 \(\textit{dist}[x][y]\) 相矛盾；</li></ul></li><li>其次证明最小高度树的根节点一定存在于 \(x\) 到 \(y\) 的路径上，假设存在节点 \(z\) 它的最小高度为 \(\textit{minheight}\)，但节点 \(z\) 不存在于 \(x\) 到 \(y\) 之间的路径上：<ul><li>设 \(z\) 到 \(x\) 的路径为 \(z \rightarrow \cdots \rightarrow a \rightarrow \cdots \rightarrow x\)，\(z\) 到 \(y\) 的路径为 \(z \rightarrow \cdots \rightarrow a \rightarrow \cdots \rightarrow y\)，这两个路径之间一定存在公共的交叉点，假设交叉点为 \(a\), 则可以知道此时 \(z\) 到 \(x\) 的距离为 \(\textit{dist}[z][x] = \textit{dist}[z][a] + \textit{dist}[a][z]\)，\(z\) 到 \(y\) 的距离为 \(\textit{dist}[z][y] = \textit{dist}[z][a] + \textit{dist}[a][y]\)，由于树的高度小 \(h = \textit{minheight}\)，所以可以推出 \(\textit{dist}[z][a] + \textit{dist}[a][x] \le \textit{minheight}\)，\(\textit{dist}[z][a] + \textit{dist}[a][y] \le \textit{minheight}\)，由于 \(z\) 不在 \(x\) 到 \(y\) 的路径上，所以可以知道 \(\textit{dist}[z][a] \ge 1\)，即可以推出 \(\textit{dist}[a][x] &lt; \textit{minheight}，\textit{dist}[a][y] &lt; \textit{minheight}\)，即可以推出 \(\textit{dist}[a][x] + \textit{dist}[a][y] \le 2 \times \textit{minheight} - 2 = 2 \times \Big \lceil \dfrac{\textit{dist}[x][y]}{2} \Big \rceil - 2 &lt; \textit{dist}[x][y]\)，这与 \(x\) 到 \(y\) 的距离为 \(\textit{dist}[x][y]\) 相矛盾。</li></ul></li></ul><p>综合上述推理，设两个叶子节点的最长距离为 \(\textit{maxdist}\)，可以得到结论最小高度树的高度为 \(\Big \lceil \dfrac{\textit{maxdist}}{2} \Big \rceil\)，且最小高度树的根节点一定存在其最长路径上。</p><p>假设最长的路径的 \(m\) 个节点依次为 \(p_1 \rightarrow p_2 \rightarrow \cdots \rightarrow p_m\)，最长路径的长度为 \(m-1\)，可以得到以下结论：+ 如果 \(m\) 为偶数，此时最小高度树的根节点为 \(p_{\frac{m}{2}}\) 或者 \(p_{\frac{m}{2} + 1}\)，且此时最小的高度为 \(\dfrac{m}{2}\)；+ 如果 \(m\) 为奇数，此时最小高度树的根节点为 \(p_{\frac{m+1}{2}}\)，且此时最小的高度为 \(\dfrac{m-1}{2}\)。</p><p>因此我们只需要求出路径最长的两个叶子节点即可，并求出其路径的最中间的节点即为最小高度树的根节点。</p><p>可以利用以下算法找到图中距离最远的两个节点与它们之间的路径：+ 以任意节点 \(p\) 出现，利用广度优先搜索或者深度优先搜索找到以 \(p\) 为起点的最长路径的终点 \(x\)；+ 以节点 \(x\) 出发，找到以 \(x\) 为起点的最长路径的终点 \(y\)；+ \(x\) 到 \(y\) 之间的路径即为图中的最长路径，找到路径的中间节点即为根节点。</p><p>上述算法的证明可以参考「<a href=http://courses.csail.mit.edu/6.046/fall01/handouts/ps9sol.pdf>算法导论习题解答 9-1</a>」。</p><p>在此我们利用广度优先搜索来找到节点的最长路径，首先找到距离节点 \(0\) 的最远节点 \(x\)，然后找到距离节点 \(x\) 的最远节点 \(y\)，然后找到节点 \(x\) 与节点 \(y\) 的路径，然后找到根节点。</p><p><strong>复杂度分析</strong></p><ul><li><p>时间复杂度：\(O(n)\)，其中 \(n\) 是为节点的个数。图中边的个数为 \(n-1\)，因此建立图的关系需要的时间复杂度为 \(O(n)\)，通过广度优先搜索需要的时间复杂度为 \(O(n + n - 1)\)，求最长路径的时间复杂度为 \(O(n)\)，因此总的时间复杂度为 \(O(n)\)。</p></li><li><p>空间复杂度：\(O(n)\)，其中 \(n\) 是节点的个数。由于题目给定的图中任何两个顶点都只有一条路径连接，因此图中边的数目刚好等于 \(n-1\)，用邻接表构造图所需的空间刚好为 \(O(2 \times n)\)，存储每个节点的距离和父节点均为 \(O(n)\)，使用广度优先搜索时，队列中最多有 \(n\) 个元素，所需的空间也为 \(O(n)\)，因此空间复杂度为 \(O(n)\)。</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>findLongestNode</span><span class=p>(</span><span class=kt>int</span> <span class=n>u</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=o>&amp;</span> <span class=n>parent</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>adj</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=n>adj</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>queue</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>qu</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span> <span class=n>visit</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>qu</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>u</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>visit</span><span class=p>[</span><span class=n>u</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>node</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>qu</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>curr</span> <span class=o>=</span> <span class=n>qu</span><span class=p>.</span><span class=n>front</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>qu</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span> <span class=o>=</span> <span class=n>curr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=o>&amp;</span> <span class=nl>v</span> <span class=p>:</span> <span class=n>adj</span><span class=p>[</span><span class=n>curr</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>visit</span><span class=p>[</span><span class=n>v</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>visit</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>parent</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>curr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>qu</span><span class=p>.</span><span class=n>emplace</span><span class=p>(</span><span class=n>v</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>node</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>findMinHeightTrees</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;&amp;</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>adj</span><span class=p>(</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=o>&amp;</span> <span class=nl>edge</span> <span class=p>:</span> <span class=n>edges</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>adj</span><span class=p>[</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>]].</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>            <span class=n>adj</span><span class=p>[</span><span class=n>edge</span><span class=p>[</span><span class=mi>1</span><span class=p>]].</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>edge</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>parent</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* 找到与节点 0 最远的节点 x */</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=n>findLongestNode</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>parent</span><span class=p>,</span> <span class=n>adj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* 找到与节点 x 最远的节点 y */</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=n>findLongestNode</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>parent</span><span class=p>,</span> <span class=n>adj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* 求出节点 x 到节点 y 的路径 */</span>
</span></span><span class=line><span class=cl>        <span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>path</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>parent</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=p>(</span><span class=n>y</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>path</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>y</span> <span class=o>=</span> <span class=n>parent</span><span class=p>[</span><span class=n>y</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>path</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=n>path</span><span class=p>[</span><span class=n>m</span> <span class=o>/</span> <span class=mi>2</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>path</span><span class=p>[</span><span class=n>m</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=n>path</span><span class=p>[</span><span class=n>m</span> <span class=o>/</span> <span class=mi>2</span><span class=p>]};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div></article></div></div></div></div></div></div></main></div><script type=application/javascript src=https://tategotoazarasi.github.io/js/toc.js></script><link rel=stylesheet href=https://tategotoazarasi.github.io/css/toc.css><div class="footer container-xl width-full p-responsive"><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><a aria-label=Homepage title=GitHub class="footer-octicon d-none d-lg-block mr-lg-4" href=https://tategotoazarasi.github.io/><svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"><li class="mr-3 mr-lg-0">Theme by <a href=https://github.com/MeiK2333/github-style>github-style</a></li></ul></div><div class="d-flex flex-justify-center pb-6"><span class="f6 text-gray-light"></span></div></div></body><script type=application/javascript src=https://tategotoazarasi.github.io/js/github-style.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css integrity=sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js integrity=sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload=renderMathInElement(document.body)></script></html>