<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width"><script type=application/javascript src=https://tategotoazarasi.github.io/js/theme-mode.js></script><link rel=stylesheet href=https://tategotoazarasi.github.io/css/frameworks.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github.min.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/github-style.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/light.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/dark.css><link rel=stylesheet href=https://tategotoazarasi.github.io/css/syntax.css><title>LeetCode 608. Tree Node - Harp Seal Pup Nursery and Caring Center</title>
<link rel=icon type=image/x-icon href=/images/github.png><meta name=theme-color content="#1e2327"><meta name=description content="Table: Tree
Column Name Type id int p_id int id is the primary key column for this table. Each row of this table contains information about the id of a node and the id of its parent node in a tree. The given structure is always a valid tree.
Each node in the tree can be one of three types:
&amp;ldquo;Leaf&amp;rdquo;: if the node is a leaf node. &amp;ldquo;Root&amp;rdquo;: if the node is the root of the tree. &amp;ldquo;Inner&amp;rdquo;: If the node is neither a leaf node nor a root node. Write an SQL query to report the type of each node in the tree.
Return the result table ordered by id in ascending order.
The query result format is in the following example.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tategotoazarasi.github.io/post/tree-node/><meta name=twitter:card content="summary"><meta name=twitter:title content="LeetCode 608. Tree Node - Harp Seal Pup Nursery and Caring Center"><meta name=twitter:description content="Table: Tree
Column Name Type id int p_id int id is the primary key column for this table. Each row of this table contains information about the id of a node and the id of its parent node in a tree. The given structure is always a valid tree.
Each node in the tree can be one of three types:
&amp;ldquo;Leaf&amp;rdquo;: if the node is a leaf node. &amp;ldquo;Root&amp;rdquo;: if the node is the root of the tree. &amp;ldquo;Inner&amp;rdquo;: If the node is neither a leaf node nor a root node. Write an SQL query to report the type of each node in the tree.
Return the result table ordered by id in ascending order.
The query result format is in the following example.
"><meta name=twitter:site content="https://tategotoazarasi.github.io/"><meta name=twitter:creator content><meta name=twitter:image content="https://tategotoazarasi.github.io/"><meta property="og:type" content="article"><meta property="og:title" content="LeetCode 608. Tree Node - Harp Seal Pup Nursery and Caring Center"><meta property="og:description" content="Table: Tree
Column Name Type id int p_id int id is the primary key column for this table. Each row of this table contains information about the id of a node and the id of its parent node in a tree. The given structure is always a valid tree.
Each node in the tree can be one of three types:
&amp;ldquo;Leaf&amp;rdquo;: if the node is a leaf node. &amp;ldquo;Root&amp;rdquo;: if the node is the root of the tree. &amp;ldquo;Inner&amp;rdquo;: If the node is neither a leaf node nor a root node. Write an SQL query to report the type of each node in the tree.
Return the result table ordered by id in ascending order.
The query result format is in the following example.
"><meta property="og:url" content="https://tategotoazarasi.github.io/post/tree-node/"><meta property="og:site_name" content="LeetCode 608. Tree Node"><meta property="og:image" content="https://tategotoazarasi.github.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-04-07 12:05:45 +0800 +0800"></head><body><div style=position:relative><header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"><div class="Header-item mobile-none" style=margin-top:-4px;margin-bottom:-4px><a class=Header-link href=https://tategotoazarasi.github.io/><img class=octicon height=32 width=32 src=/images/github.png></a></div><div class="Header-item d-md-none"><button class="Header-link btn-link js-details-target" type=button onclick='document.querySelector("#header-search").style.display=document.querySelector("#header-search").style.display=="none"?"block":"none"'><svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button></div><div style=display:none id=header-search class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"><div class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"><div class=position-relative><form target=_blank action=https://www.google.com/search accept-charset=UTF-8 method=get autocomplete=off><label class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"><input type=text class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" name=q placeholder=Search autocomplete=off>
<input type=hidden name=q value=site:https://tategotoazarasi.github.io/></label></form></div></div></div><div class="Header-item Header-item--full flex-justify-center d-md-none position-relative"><a class=Header-link href=https://tategotoazarasi.github.io/><img class="octicon octicon-mark-github v-align-middle" height=32 width=32 src=/images/github.png></a></div><div class=Header-item style=margin-right:0><a href=javascript:void(0) class="Header-link no-select" onclick=switchTheme()><svg style="fill:var(--color-profile-color-modes-toggle-moon)" class="no-select" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.52208 7.71754c3.05612.0 5.53362-2.47748 5.53362-5.5336C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961 9.95801 1.07727 10.3495.771159 10.6474.99992c1.4679 1.12724 2.4141 2.90007 2.4141 4.89391.0 3.40575-2.7609 6.16667-6.16665 6.16667-2.94151.0-5.40199-2.0595-6.018122-4.81523C.794841 6.87902 1.23668 6.65289 1.55321 6.85451 2.41106 7.40095 3.4296 7.71754 4.52208 7.71754z"/></svg></a></div></header></div><div><main><div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4"><div class=px-0><div class="mb-3 d-flex px-3 px-md-3 px-lg-5"><div class="flex-auto min-width-0 width-fit mr-3"><div class=d-flex><div class="d-none d-md-block"><a class="avatar mr-2 flex-shrink-0" href=https://tategotoazarasi.github.io/><img class=avatar-user src=/images/myavatar.webp width=32 height=32></a></div><div class="d-flex flex-column"><h1 class="break-word f3 text-normal mb-md-0 mb-1"><span class=author><a href=https://tategotoazarasi.github.io/>azarasi</a>
</span><span class=path-divider>/</span>
<strong class="css-truncate css-truncate-target mr-1" style=max-width:410px><a href=https://tategotoazarasi.github.io/post/tree-node/>LeetCode 608. Tree Node</a></strong></h1><div class="note m-0">Created <relative-time datetime="Thu, 07 Apr 2022 12:05:45 +0800" class=no-wrap>Thu, 07 Apr 2022 12:05:45 +0800</relative-time>
<span class=file-info-divider></span>
Modified <relative-time datetime="Mon, 22 Jul 2024 11:29:37 +0000" class=no-wrap>Mon, 22 Jul 2024 11:29:37 +0000</relative-time></div></div></div></div></div></div></div><div class="container-lg px-3 new-discussion-timeline"><div class="repository-content gist-content"><div><div class="js-gist-file-update-container js-task-list-container file-box"><div id=file-pytest class="file my-2"><div id=post-header class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style=z-index:2><div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto"><div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0"><summary id=toc-toggle onclick=clickToc() class="btn btn-octicon m-0 mr-2 p-2"><svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered"><path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zm0 5a.75.75.0 000 1.5h8.5a.75.75.0 000-1.5h-8.5zM3 8A1 1 0 111 8a1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/></svg></summary><details-menu class=SelectMenu id=toc-details style="display: none;"><div class="SelectMenu-modal rounded-3 mt-1" style=max-height:340px><div class="SelectMenu-list SelectMenu-list--borderless p-2" style=overscroll-behavior:contain id=toc-list></div></div></details-menu>764 Words</div><div class="file-actions flex-order-2 pt-0"><a class="muted-link mr-3" href=/tags/leetcode><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
leetcode
</a><a class="muted-link mr-3" href=/tags/%E7%AE%80%E5%8D%95><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
简单
</a><a class="muted-link mr-3" href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
数据库
</a><a class="muted-link mr-3" href=/tags/%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2-%E6%8C%87%E5%AE%9A%E9%80%89%E5%8F%96><svg class="octicon octicon-tag" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25.0 01.25-.25h5.025a.25.25.0 01.177.073l6.25 6.25a.25.25.0 010 .354l-5.025 5.025a.25.25.0 01-.354.0l-6.25-6.25A.25.25.0 012.5 7.775zm-1.5.0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464.0.91.184 1.238.513l6.25 6.25a1.75 1.75.0 010 2.474l-5.026 5.026a1.75 1.75.0 01-2.474.0l-6.25-6.25A1.75 1.75.0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"/></svg>
组合查询 & 指定选取</a></div></div></div><div class="Box-body px-5 pb-5" style=z-index:1><article class="markdown-body entry-content container-lg"><p>Table: <code>Tree</code></p><table><thead><tr><th>Column Name</th><th>Type</th></tr></thead><tbody><tr><td>id</td><td>int</td></tr><tr><td>p_id</td><td>int</td></tr></tbody></table><p>id is the primary key column for this table.
Each row of this table contains information about the id of a node and the id of its parent node in a tree.
The given structure is always a valid tree.</p><p>Each node in the tree can be one of three types:</p><ul><li><strong>&ldquo;Leaf&rdquo;</strong>: if the node is a leaf node.</li><li><strong>&ldquo;Root&rdquo;</strong>: if the node is the root of the tree.</li><li><strong>&ldquo;Inner&rdquo;</strong>: If the node is neither a leaf node nor a root node.</li></ul><p>Write an SQL query to report the type of each node in the tree.</p><p>Return the result table <strong>ordered</strong> by <code>id</code> <strong>in ascending order</strong>.</p><p>The query result format is in the following example.</p><p><strong>Example 1:</strong></p><p><img src=/images/608tree1.jpg alt></p><p><strong>Input:</strong>
Tree table:</p><table><thead><tr><th>id</th><th>p_id</th></tr></thead><tbody><tr><td>1</td><td>null</td></tr><tr><td>2</td><td>1</td></tr><tr><td>3</td><td>1</td></tr><tr><td>4</td><td>2</td></tr><tr><td>5</td><td>2</td></tr></tbody></table><p><strong>Output:</strong></p><table><thead><tr><th>id</th><th>type</th></tr></thead><tbody><tr><td>1</td><td>Root</td></tr><tr><td>2</td><td>Inner</td></tr><tr><td>3</td><td>Leaf</td></tr><tr><td>4</td><td>Leaf</td></tr><tr><td>5</td><td>Leaf</td></tr></tbody></table><p><strong>Explanation:</strong>
Node 1 is the root node because its parent node is null and it has child nodes 2 and 3.
Node 2 is an inner node because it has parent node 1 and child node 4 and 5.
Nodes 3, 4, and 5 are leaf nodes because they have parent nodes and they do not have child nodes.</p><p><strong>Example 2:</strong></p><p><img src=/images/608tree2.jpg alt></p><p><strong>Input:</strong>
Tree table:</p><table><thead><tr><th>id</th><th>p_id</th></tr></thead><tbody><tr><td>1</td><td>null</td></tr></tbody></table><p><strong>Output:</strong></p><table><thead><tr><th>id</th><th>type</th></tr></thead><tbody><tr><td>1</td><td>Root</td></tr></tbody></table><p><strong>Explanation:</strong> If there is only one node on the tree, you only need to output its root attributes.</p><h4 id=方法-1使用-union>方法 1：使用 <code>UNION</code></h4><p><strong>想法</strong>我们可以按照下面的定义，求出每一条记录的节点类型。</p><ul><li>Root: 没有父节点</li><li>Inner: 它是某些节点的父节点，且有非空的父节点</li><li>Leaf: 除了上述两种情况以外的节点</li></ul><p><strong>算法</strong>将上述定义转化，我们可以得到下面的代码。</p><p>根节点是没有父节点的节点。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=s1>&#39;Root&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>叶子节点是没有孩子节点的节点，且它有父亲节点。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=s1>&#39;Leaf&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>p_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>内部节点是有孩子节点和父节点的节点。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=s1>&#39;Inner&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>p_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>所以本题的一种解法是将这些情况用 <code>UNION</code> 合并起来。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=s1>&#39;Root&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=s1>&#39;Leaf&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>p_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=s1>&#39;Inner&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>p_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=方法-ii使用流控制语句-case>方法 II：使用流控制语句 <code>CASE</code></h4><p><strong>算法</strong></p><p>与上面解法类似，本解法使用流控制语句，流控制语句对基于不同输入产生不同输出非常有效。</p><p>本方法中，我们使用 <a href=https://dev.mysql.com/doc/refman/5.7/en/case.html><code>CASE</code></a> 语句。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w>      </span><span class=k>AS</span><span class=w> </span><span class=o>`</span><span class=n>Id</span><span class=o>`</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>CASE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>WHEN</span><span class=w> </span><span class=n>tree</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>SELECT</span><span class=w> </span><span class=n>atree</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w> </span><span class=n>atree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>WHERE</span><span class=w> </span><span class=n>atree</span><span class=p>.</span><span class=n>p_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Root&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>WHEN</span><span class=w> </span><span class=n>tree</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>SELECT</span><span class=w> </span><span class=n>atree</span><span class=p>.</span><span class=n>p_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w> </span><span class=n>atree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=p>)</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Inner&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Leaf&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=o>`</span><span class=n>Id</span><span class=o>`</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><blockquote><p>MySQL 除了 <code>CASE</code> 语句以外还提供了不同的流控制语句。</p></blockquote><p>你可以尝试将上面的方法用 <a href=https://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html#function_if><code>IF</code></a> 重写。</p><h4 id=方法-iii使用-if-函数>方法 III；使用 <code>IF</code> 函数</h4><p><strong>算法</strong></p><p>我们还可以使用 <a href=https://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html#function_if><code>IF</code></a> 函数来避免复杂的流控制语句。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>atree</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>IF</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>ISNULL</span><span class=p>(</span><span class=n>atree</span><span class=p>.</span><span class=n>p_id</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=s1>&#39;Root&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=k>IF</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=n>atree</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=k>SELECT</span><span class=w> </span><span class=n>p_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=s1>&#39;Inner&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                           </span><span class=s1>&#39;Leaf&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                   </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=p>)</span><span class=w> </span><span class=k>Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>tree</span><span class=w> </span><span class=n>atree</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>atree</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div></article></div></div></div></div></div></div></main></div><script type=application/javascript src=https://tategotoazarasi.github.io/js/toc.js></script><link rel=stylesheet href=https://tategotoazarasi.github.io/css/toc.css><div class="footer container-xl width-full p-responsive"><div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"><a aria-label=Homepage title=GitHub class="footer-octicon d-none d-lg-block mr-lg-4" href=https://tategotoazarasi.github.io/><svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" width="24"><path fill-rule="evenodd" d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.013 8.013.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0"><li class="mr-3 mr-lg-0">Theme by <a href=https://github.com/MeiK2333/github-style>github-style</a></li></ul></div><div class="d-flex flex-justify-center pb-6"><span class="f6 text-gray-light"></span></div></div></body><script type=application/javascript src=https://tategotoazarasi.github.io/js/github-style.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css integrity=sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js integrity=sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload=renderMathInElement(document.body)></script></html>